university_internal_slot_1 = {
    slot = 1
    generic = no
    ai = yes
    has_country_shield = yes
    potential = { tag = UNI }

    uni_new_income_streams = {
        icon = mission_build_up_to_force_limit
        position = 3
        required_missions = {
            uni_of_bursars_and_burghers
        }
        trigger = {
            num_of_owned_provinces_with = {
                value = 3
                province_has_center_of_trade_of_level = 1
            }
        }
        effect = {
            add_mercantilism = 3
            custom_tooltip = unirtm_tt
            hidden_effect = {
                set_country_flag = UNI_remove_trade_malus
            }
        }
    }
}

university_internal_slot_2 = {
    slot = 2
    generic = no
    ai = yes
    has_country_shield = yes
    potential = { tag = UNI }

    uni_of_bursars_and_burghers = {
        icon = mission_build_up_to_force_limit
        position = 2
        required_missions = {
            uni_northern_victory
        }
        trigger = {
            NOT = { num_of_loans = 1 }
            has_dip_advisor = yes
        }
        effect = {
            custom_tooltip = unirim_tt
            hidden_effect = {
                set_country_flag = UNI_remove_inflation_malus
            }         
        }
    }

    uni_theory_into_practice = {
        icon = mission_build_up_to_force_limit
        position = 3
        required_missions = {
            uni_of_bursars_and_burghers
        }
        provinces_to_highlight = {
            OR = {
                province_id = 77
                province_id = 70
            }
        }
        trigger = {
            77 = { 
                base_production = 10
            }
            70 = {
                base_production = 10
            }
        }
        effect = {
            77 = {
                change_trade_goods = paper
            }
            70 = {
                change_trade_goods = glass
            }
            custom_tooltip = unirpm_tt
            hidden_effect = {
                set_country_flag = UNI_remove_production_malus
            }
        }
    }

    uni_righting_the_books = {
        icon = mission_build_up_to_force_limit
        position = 4
        required_missions = {
            uni_theory_into_practice
            uni_new_income_streams
        }
        trigger = {
            estate_loyalty = {
                estate = estate_burghers
                loyalty = 60
            }
            NOT = {
                estate_influence = {
                    estate = estate_burghers
                    influence = 40
                }
            }     
        }
        effect = {
            remove_estate_privilege = estate_burghers_UNI_merchant_dependance
            add_estate__loyalty_modifier = {
                estate = estate_burghers
                desc = UNI_BL
                loyalty = 5
                duration = -1
            }
        }
    }
}

university_internal_slot_3 = {
    slot = 3
    generic = no
    ai = yes
    has_country_shield = yes
    potential = { tag = UNI }

    uni_northern_victory = {
        icon = mission_build_up_to_force_limit
        position = 1
        required_missions = { }
        provinces_to_highlight = {
            OR = {
                province_id = 68
                province_id = 72
                province_id = 4712
                province_id = 4713
            }
        }
        trigger = {
            owns_core_province = 68
            owns_core_province = 72
            owns_core_province = 4712
            owns_core_province = 4713
        }
        effect = {
            country_event = {
                id = university_events.2
            }
        }
    }

    uni_a_godly_headache = {
        icon = mission_build_up_to_force_limit
        position = 2
        required_missions = { 
            uni_northern_victory
        }
        trigger = {
            num_of_owned_provinces_with = {
                value = 3
                has_building = temple
            }
        }
        effect = {
            remove_country_modifier = uni_clerical_opposition
            4712 = {
                add_province_modifier = {
                    name = "uni_seat_of_rebellion"
                    duration = -1
                }
            }
        }
    }

    uni_teaching_a_lesson = {
        icon = mission_build_up_to_force_limit
        position = 4
        required_missions = { 
            uni_a_godly_headache
        }
        provinces_to_highlight = {
            province_id = 77
        }
        trigger = {
            has_institution = renaissance
            stability = 1
            77 = {
                development = 30
                fort_level = 3
                has_building = marketplace
            }
        }
        effect = {
            4712 = {
                remove_province_modifier = uni_seat_of_rebellion
            }
        }
    }

    uni_the_fundamentals = {
        icon = mission_build_up_to_force_limit
        position = 5
        required_missions = { 
            uni_teaching_a_lesson
            uni_righting_the_books
            uni_the_gelehrterwache
        }
        trigger = {
            has_adm_advisor = yes
            has_dip_advisor = yes
            has_mil_advisor = yes
            is_in_deficit = no
            NOT = {
                num_of_loans = 1
            }
        }
        effect = {

        }
    }
}

university_internal_slot_4 = {
    slot = 4
    generic = no
    ai = yes
    has_country_shield = yes
    potential = { tag = UNI }

    uni_discrete_recruiting = {
        icon = mission_build_up_to_force_limit
        position = 2
        required_missions = { 
            uni_northern_victory
        }
        trigger = {
            manpower_percentage = 0.50
            has_mil_advisor = yes
        }
        effect = {
            custom_tooltip = unirmm_tt
            hidden_effect = {
                set_country_flag = UNI_remove_manpower_malus
            }
            country_event = {
                id = university_events.3
                days = 90
                random = 60
            }
        }
    }

    uni_ancient_history = {
        icon = mission_build_up_to_force_limit
        position = 3
        required_missions = { 
            uni_discrete_recruiting
        }
        trigger = {
            #TODO has_disaster
            has_country_modifier = uni_noble_coup
            NOT = {
                any_owned_province = {
                    has_province_modifier = uni_noble_stronghold
                }
            }
        }
        effect = {
            custom_tooltip = unirflm_tt
            hidden_effect = {
                set_country_flag = UNI_remove_forcelimit_malus
            }
        }
    }

    uni_the_gelehrterwache = {
        icon = mission_build_up_to_force_limit
        position = 4
        required_missions = { 
            uni_ancient_history
            uni_eye_for_talent
        }
        provinces_to_highlight = {
            province_id = 74
        }
        trigger = {
            74 = {
                NOT = {
                    has_province_modifier = uni_the_old_capital
                }
            }     
            NOT = {
                has_spawned_rebels = pretender_rebels
            }
        }
        effect = {
            remove_estate_privilege = estate_nobles_UNI_ambitious_nobles
            country_event = {
                id = university_events.4
            }
        }
    }
}

university_internal_slot_5 = {
    slot = 5
    generic = no
    ai = yes
    has_country_shield = yes
    potential = { tag = UNI }

    uni_eye_for_talent = {
        icon = mission_build_up_to_force_limit
        position = 3
        required_missions = { 
            uni_discrete_recruiting
        }
        trigger = {
            calc_true_if = {
                any_province = {
                    NOT = {
                        owned_by = UNI
                    }
                    controlled_by = UNI
                    fort_level = 2
                }
                amount = 3
            }         
        }
        effect = {
            custom_tooltip = unirgm_tt
            hidden_effect = {
                set_country_flag = UNI_remove_general_malus
            }
        }
    }
}
